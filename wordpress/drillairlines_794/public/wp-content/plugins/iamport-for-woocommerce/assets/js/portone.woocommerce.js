jQuery(function(p){var m=["iamport_card","iamport_samsung","iamport_trans","iamport_vbank","iamport_phone","iamport_kakao","iamport_kpay","iamport_payco","iamport_eximbay","iamport_subscription_ex","iamport_naverpay_ext","iamport_hub_naverpay","iamport_paymentwall"],r=function(){for(var r=[],a=m.length,e=0;e<a;e++)r.push("checkout_place_order_"+m[e]);return r}();function n(r,a){for(var e=r.split("."),o=a.split("."),t=0;t<3;t++){if(parseInt(e[t])>parseInt(o[t]))return 1;if(parseInt(e[t])<parseInt(o[t]))return-1}return 0}function u(r){r.removeClass("processing").unblock()}function c(r,a){"true"===a.reload?window.location.reload():(p(".iamport-error-wrap").remove(),r.prepend('<div class="iamport-error-wrap">'+a.messages+"</div>"),r.removeClass("processing").unblock(),r.find(".input-text, select").blur(),p("html, body").animate({scrollTop:r.offset().top-100},1e3),"true"===a.refresh&&p("body").trigger("update_checkout"),p("body").trigger("checkout_error"))}p('form[name="checkout"]').on(r.join(" "),function(){var o=p(this),r=o.find('input[name="payment_method"]:checked').val(),t="card",a="iamport_",r=(0==r.indexOf(a)&&(t=r.substring(a.length)),o.find('input[name="payment_method"]:checked').closest("li").find(".iamport_payment_method_secondary")),i=null;return 0<r.length&&(i=r.val()),o.addClass("processing"),1!==o.data()["blockUI.isBlocked"]&&o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),p.ajax({type:"POST",url:wc_checkout_params.checkout_url,data:o.serialize(),dataType:"json",dataFilter:function(r){var a=r.match(/{(.*)}/);return a?a[0]:r},success:function(a){try{if("success"!==a.result)throw a.result,a;var r={pay_method:a.iamport.pay_method||t,escrow:a.iamport.escrow,merchant_uid:a.iamport.merchant_uid,name:a.iamport.name,amount:parseFloat(a.iamport.amount),buyer_email:a.iamport.buyer_email,buyer_name:a.iamport.buyer_name,buyer_tel:a.iamport.buyer_tel,buyer_addr:a.iamport.buyer_addr,buyer_postcode:a.iamport.buyer_postcode,vbank_due:a.iamport.vbank_due,m_redirect_url:a.iamport.m_redirect_url,currency:a.iamport.currency,digital:a.iamport.digital||!1,custom_data:{woocommerce:a.order_id,devops:"codemshop"},biz_num:a.iamport.biz_num,niceMobileV2:!0};if(-1!=navigator.userAgent.toLowerCase().indexOf("mobileapp")&&(r=Object.assign(r,{app_scheme:a.iamport.app_scheme})),i?r.pg=i:a.iamport.pg&&(r.pg=a.iamport.pg),"number"==typeof a.iamport.tax_free&&(r.tax_free=a.iamport.tax_free),a.iamport.language&&(r.language=a.iamport.language),a.iamport.customer_uid&&(r.customer_uid=a.iamport.customer_uid),a.iamport.customer_id&&(r.customer_id=a.iamport.customer_id),a.iamport.kcpProducts&&(r.kcpProducts=a.iamport.kcpProducts),a.iamport.naverPopupMode&&(r.naverPopupMode=!0),a.iamport.naverProducts&&(r.naverProducts=a.iamport.naverProducts),a.iamport.naverUseCfm&&(r.naverUseCfm=a.iamport.naverUseCfm),a.iamport.notice_url&&(r.notice_url=a.iamport.notice_url),a.iamport.period&&(r.period=a.iamport.period),a.iamport.card_quota&&(r.display={card_quota:a.iamport.card_quota}),0<=n(p.fn.jquery,"1.8.0")&&(void 0===window.$&&(window.$=p),r.kakaoOpenApp=!0),void 0!==a.iamport.pg&&a.iamport.pg.startsWith("eximbay")){var e=o.find("#iamport_eximbay-pay-method").val();if("econtext"===(r.pay_method=e)&&"JPY"!==r.currency)return alert("엑심베이 일본 편의점 결제는 엔화(¥)만 허용됩니다. 통화를 변경하고 다시 시도해주세요"),void window.location.reload()}IMP.init(a.iamport.user_code),a.iamport.unblock&&u(o),IMP.request_pay(r,function(r){1==r.success||null==r.error_msg?window.location.href=a.iamport.m_redirect_url+"&imp_uid="+r.imp_uid:(alert(r.error_msg),window.location.reload())})}catch(r){c(o,r)}},error:function(r,a,e){alert(e),window.location.reload()}}),!1}),p('form#order_review:not([name="checkout"])').on("submit",function(r){var e=p(this),a=p("input[name=payment_method]:checked").val();if(!function(r){for(var a=m.length-1;0<=a;a--)if(r===m[a])return 1}(a))return!0;r.preventDefault(),r.stopImmediatePropagation();var o=a.substring("iamport_".length),r=p.IamportUrl("?key"),t=("kakao"==o&&(o="card"),e.find('input[name="payment_method"]:checked').closest("li").find(".iamport_payment_method_secondary")),i=null;return 0<t.length&&(i=t.val()),p.ajax({type:"GET",url:wc_checkout_params.ajax_url,data:{action:"iamport_payment_info",pay_method:o,order_key:r,gateway_name:a},dataType:"json",dataFilter:function(r){var a=r.match(/{(.*)}/);return a?a[0]:r},success:function(a){try{if("success"!==a.result)throw a.result,a;var r={pay_method:a.iamport.pay_method||o,escrow:a.iamport.escrow,merchant_uid:a.iamport.merchant_uid,name:a.iamport.name,amount:parseFloat(a.iamport.amount),buyer_email:a.iamport.buyer_email,buyer_name:a.iamport.buyer_name,buyer_tel:a.iamport.buyer_tel,buyer_addr:a.iamport.buyer_addr,buyer_postcode:a.iamport.buyer_postcode,vbank_due:a.iamport.vbank_due,m_redirect_url:a.iamport.m_redirect_url,currency:a.iamport.currency,digital:a.iamport.digital||!1,custom_data:{woocommerce:a.order_id,devops:"codemshop"},biz_num:a.iamport.biz_num,niceMobileV2:!0};-1!=navigator.userAgent.toLowerCase().indexOf("mobileapp")&&(r=Object.assign(r,{app_scheme:a.iamport.app_scheme})),i?r.pg=i:a.iamport.pg&&(r.pg=a.iamport.pg),"number"==typeof a.iamport.tax_free&&(r.tax_free=a.iamport.tax_free),a.iamport.language&&(r.language=a.iamport.language),a.iamport.customer_uid&&(r.customer_uid=a.iamport.customer_uid),a.iamport.customer_id&&(r.customer_id=a.iamport.customer_id),a.iamport.kcpProducts&&(r.kcpProducts=a.iamport.kcpProducts),a.iamport.naverPopupMode&&(r.naverPopupMode=!0),a.iamport.naverProducts&&(r.naverProducts=a.iamport.naverProducts),a.iamport.naverUseCfm&&(r.naverUseCfm=a.iamport.naverUseCfm),a.iamport.notice_url&&(r.notice_url=a.iamport.notice_url),a.iamport.period&&(r.period=a.iamport.period),a.iamport.card_quota&&(r.display={card_quota:a.iamport.card_quota}),0<=n(p.fn.jquery,"1.8.0")&&(void 0===window.$&&(window.$=p),r.kakaoOpenApp=!0),"eximbay"==a.iamport.pg&&(r.pay_method=e.find("#iamport_eximbay-pay-method").val()),IMP.init(a.iamport.user_code),a.iamport.unblock&&u(e),IMP.request_pay(r,function(r){1==r.success||null==r.error_msg?window.location.href=a.iamport.m_redirect_url+"&imp_uid="+r.imp_uid:(alert(r.error_msg),window.location.reload())})}catch(r){c(e,r)}},error:function(r,a,e){alert(e),window.location.reload()}}),!1})});