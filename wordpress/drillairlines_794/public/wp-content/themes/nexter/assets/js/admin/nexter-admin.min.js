"use strict";function showToast(e,t=!1,n=2500){const o=document.querySelector("#nexter-toast-template .nexter-toast"),s=document.getElementById("nexter-toast-container");if(o&&s){const r=o.cloneNode(!0);return r.textContent=e,t&&(r.innerHTML='<div class="nxt-loader"></div><span>'+e+"</span>"),s.appendChild(r),setTimeout(()=>r.classList.add("show"),20),t||setTimeout(()=>{r.classList.remove("show"),setTimeout(()=>r.remove(),250)},n),r}}window.onload=function(){var e=document.querySelector(".nexter-ext-notice .notice-dismiss");e&&e.addEventListener("click",function(){var e=new XMLHttpRequest;e.open("POST",nexter_admin_config.ajaxurl,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),e.onload=function(){},e.send("action=nexter_ext_dismiss_notice&nexter_nonce="+nexter_admin_config.ajax_nonce)});let t=document.querySelector(".nexter-install-ext");t&&t.addEventListener("click",e=>{e.currentTarget.innerHTML="<span class='nexter-loading-circle'></span>";var t=new XMLHttpRequest;t.open("POST",nexter_admin_config.ajaxurl,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),t.onload=function(){if(200<=t.status&&t.status<400)try{var e=JSON.parse(t.responseText);e.Success&&e.redirectUrl?window.location.href=e.redirectUrl:console.error("Failed to process request:",e)}catch(e){console.error("Error parsing response:",e)}else console.error("Request failed with status:",t.status)},t.send("action=nexter_ext_install&nexter_nonce="+nexter_admin_config.ajax_nonce)})},document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("nexter-save-settings");e&&e.addEventListener("click",function(e){e.preventDefault();let n={};document.querySelectorAll(".nexter-setting-toggle").forEach(e=>{var t=e.dataset.field;t&&(n[t]=e.checked?1:0)});let t=showToast("Saving settings...",!0),o=new FormData;o.append("action","nexter_save_settings"),o.append("nonce",nexter_admin_config.ajax_nonce),o.append("fields",JSON.stringify(n)),fetch(nexter_admin_config.ajaxurl,{method:"POST",credentials:"same-origin",body:o}).then(e=>e.json()).then(e=>{e.success?t.innerHTML="✅ Settings saved":t.innerHTML="❌ Save failed",setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>t.remove(),250)},2500)}).catch(()=>{t.innerHTML="❌ Save failed",setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>t.remove(),250)},2500)})})});