(()=>{var e,t;e=jQuery,(t={init:function(){e(document).on("click",".amem-copyable .copyable",this.onClickCopy),e(document).on("click",".amem-option-page .acf-tab-group a",this.onClickOptionTab),e(document).on("click",".amem-option-page a.add-role-rule",this.onClickAddRule.bind(this)),e(document).on("click",".amem-option-page a.remove-location-rule",this.onClickRemoveRule.bind(this)),e(document).on("click",".amem-option-page .email-notification-settings .handle ul, .amem-option-page .role-redirection-settings .handle ul",this.ToggleTr.bind(this)),e(document).on("change",".amem-option-page .email-notification-settings input:checkbox",this.changeEmailStatus.bind(this)),e(document).on("change",".amem-option-page .amem-field-toggle-group .acf-true-false input:checkbox",t.toggleGroup),e(document).ready((function(){e(".amem-readonly input").prop("readonly",!0)})),e(document).on("click",".amem-readonly input",(function(){return!1})),this.moveTitleDiv()},toggleGroup:function(t){const a=e(this),i=a.is(":checked"),n=a.closest(".field-group-settings-tab").find(a.closest(".amem-field-toggle-group").data("toggle-target"));n.length&&n[i?"removeClass":"addClass"]("acf-hidden")},changeEmailStatus:function(t){var a=e(t.target).closest(".settings").prev(".handle").find("span.amem-email-status");e(t.target).is(":checked")?(a.removeClass("amem-email-is-disable"),a.addClass("amem-email-is-active")):(a.removeClass("amem-email-is-active"),a.addClass("amem-email-is-disable"))},ToggleTr:function(t){e(t.target).closest(".handle").next(".settings").slideToggle(),e(t.target).closest(".email-notification-settings").toggleClass("open"),e(t.target).closest(".role-redirection-settings").toggleClass("open")},onClickCopy:function(t){if(t.stopPropagation(),!navigator.clipboard||e(t.target).is("input"))return;let a;a=e(t.target).hasClass("acf-input-wrap")?e(t.target).find("input").first().val():e(t.target).text(),navigator.clipboard.writeText(a).then((()=>{e(t.target).closest(".copyable").addClass("copied"),setTimeout((function(){e(t.target).closest(".copyable").removeClass("copied")}),2e3)}))},onClickOptionTab:function(t){t.preventDefault();var a=e(t.target).closest("li"),i=a.hasClass("active"),n=a.data("tabkey");i||(a.siblings("li.active").removeClass("active"),a.addClass("active"),e(".amem-option-page .amem-settings:not(.acf-hidden)").addClass("acf-hidden"),e(".amem-option-page .amem-settings.setting-"+n).removeClass("acf-hidden"))},onClickAddRule:function(t){t.preventDefault(),$el=e(t.target).prev("table"),$rule_type=e(t.target).data("add-rule"),this.addRule($el,$rule_type)},onClickRemoveRule:function(t){$el=e(t.target).closest("tr"),this.removeRule($el)},addRule:function(t,a){t.find("tr:last").length>0?this.duplicate(t.find("tr:last")):e.ajax({url:amem_options.ajaxurl,data:{action:"amem/add_default_rule",ruletab:a},type:"post",dataType:"json",success:this.test})},test:function(e){e.success&&e.data.content&&$el.find("tbody").append(e.data.content),console.log($el),console.log(e)},duplicate:function(t){t instanceof jQuery&&(t={target:t}),t=acf.parseArgs(t,{target:!1,search:"",replace:"",rename:!0,before:function(e){},after:function(e,t){},append:function(e,t){e.after(t)}}),t.target=t.target||t.$el;var a=t.target;t.search=t.search||a.attr("data-id"),t.replace=t.replace||acf.uniqid(),t.before(a),acf.doAction("before_duplicate",a);var i=a.clone();return t.rename&&acf.rename({target:i,search:t.search,replace:t.replace,replacer:"function"==typeof t.rename?t.rename:null}),i.removeClass("acf-clone"),i.find(".ui-sortable").removeClass("ui-sortable"),i.find("[data-select2-id]").removeAttr("data-select2-id"),i.find(".select2").remove(),i.find('.acf-is-subfields select[data-ui="1"]').each((function(){e(this).prop("id",e(this).prop("id").replace("acf_fields",acf.uniqid("duplicated_")+"_acf_fields"))})),i.find(".acf-field-settings > .acf-tab-wrap").remove(),t.after(a,i),t.append(a,i),i},removeRule:function(e){e.remove()},moveTitleDiv:function(){e(document).ready((function(){let t=e("#amem-title-wrap");t.length&&t.appendTo(".acf-headerbar-content:first").show()}))}}).init(),e(document).ready((function(){e(".amem-option-page .acf-tab-wrap").length>0&&acf.doAction("show")})),e(document).ready((function(){e(".amem-fields-sortables").sortable({items:"> .amem-sortable-item",handle:".amem-sortable-handle"}),e(document).on("click","h3.amem-field-group-title",(function(){var t=e(this).hasClass("open");e(this).closest("div").find("table")[t?"hide":"show"](),e(this)[t?"removeClass":"addClass"]("open")}))}))})();