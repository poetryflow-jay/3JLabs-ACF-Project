(()=>{var e,t;t=jQuery,"undefined"!=typeof acf?((e={forms:{},setup_form:function(a){var i=a.attr("data-key"),n={$el:a,key:i,submissionSteps:[]};this.pages.initialize(n),this.ajax.initialize(n),this.forms[i]=n;var s=this;n.$el.on("submit",(function(t){t.preventDefault(),e.lock(n);var a=n.$el.data("acf");a&&a.set("status",""),acf.validation.fetch({form:n.$el,failure:function(){e.unlock(n)},success:function(){var e=n.submissionSteps.slice();s.executeSubmissionSteps(n,e)},complete:function(){n.$el.find(".amem-submit-button").prop("disabled",!1)}})})),t(document).on("click",".amem-notice.-dismiss a.acf-notice-dismiss ",(function(e){e.preventDefault(),t(this).closest(".amem-notice.-dismiss").remove()})),acf.doAction("amem/form/setup",n)},lock(e){e.$el.find(".amem-submit-button").prop("disabled",!0),acf.validation.lockForm(e.$el)},unlock(e){e.$el.find(".amem-submit-button").prop("disabled",!1),acf.validation.unlockForm(e.$el)},addSubmissionStep(e,t,a){for(var i={priority:t,fn:a},n=0;n<e.submissionSteps.length;n++)if(t<e.submissionSteps[n].priority)return void e.submissionSteps.splice(n,0,i);e.submissionSteps.push(i)},executeSubmissionSteps(t,a){var i=function(){e.lock(t),t.$el.get(0).submit()};if(0!=a.length){var n,s=a.shift(),r=this;n=0==a.length?i:function(){r.executeSubmissionSteps(t,a)},s.fn(n)}else i()}}).pages={initialize:function(a){var i=this;if($page_fields=a.$el.find(".acf-field-page"),$page_fields.exists()){a.pages=[],a.current_page=0,a.max_page=0,a.show_numbering=!0,a.$page_wrap=t('<div class="amem-page-wrap">'),a.$page_wrap.insertBefore($page_fields.first()),a.$previous_button=$page_fields.first().find(".amem-previous-button"),a.$next_button=$page_fields.first().find(".amem-next-button"),a.show_numbering="true"===$page_fields.first().find(".amem-page-button").attr("data-show-numbering"),a.$previous_button.click((function(e){e.preventDefault(),i.previousPage(a)})),a.$next_button.click((function(e){e.preventDefault(),i.nextPage(a)}));var n=a.$el.find(".amem-submit");n.prepend(a.$next_button),n.prepend(a.$previous_button),a.$submit_button=n.find(".amem-submit-button");var s=0;$page_fields.each((function(i,n){var r=t(n),o=s,u=r.nextUntil(".acf-field-page",".acf-field");if(0!=u.length){var c=r.find(".amem-page-button").attr("data-index",o);c.click((function(t){t.preventDefault(),e.pages.navigateToPage(o,a)})),a.show_numbering&&($index=t('<span class="index">').html(o+1),c.prepend($index)),a.$page_wrap.append(c),a.pages.push({$field:r,$fields:u,$button:c}),s++}})),this.refresh(a)}},refresh:function(e){t.each(e.pages,(function(a,i){var n=a==e.current_page;i.$button.toggleClass("enabled",a<=e.max_page),i.$button.toggleClass("current",n),i.$fields.each((function(){t(this).toggle(n)}))}));var a=this.isFirstPage(e),i=this.isLastPage(e);e.$previous_button.attr("disabled",!!a||null),e.$next_button.toggle(!i),e.$submit_button.toggle(i)},nextPage:function(e){if(!this.isLastPage(e)){var t=this;this.validatePage(e,e.current_page,(function(){t.changePage(e.current_page+1,e)}))}},previousPage:function(e){this.isFirstPage(e)||this.changePage(e.current_page-1,e)},navigateToPage:function(e,t){if(!(e<0||e>t.max_page)){var a=this;this.validatePage(t,t.current_page,(function(){a.changePage(e,t)}))}},changePage:function(e,t){var a=t.current_page;t.current_page=e,t.max_page<=t.current_page&&(t.max_page=t.current_page),this.refresh(t),acf.doAction("amem/form/page_changed",e,a,t)},isFirstPage:function(e){return 0==e.current_page},isLastPage:function(e){return e.current_page==e.pages.length-1},validatePage:function(e,t,a){e.pages[t].$fields.find("input").each((function(){this.checkValidity()}));var n=function(a){for(i=0;i<e.pages.length;i++)i!=t&&a(e.pages[i])};n((function(e){e.$fields.detach()}));var s=function(){n((function(e){e.$fields.insertAfter(e.$field)}))};acf.validation.fetch({form:e.$el,lock:!1,reset:!0,success:function(){s(),a()},failure:function(){s()}})}},e.ajax={initialize:function(t){var a=this;t.$el.is("[data-ajax]")&&e.addSubmissionStep(t,100,(function(e){a.sendSubmission(t)}))},sendSubmission:function(a){var i=new FormData(a.$el.get(0));i.append("action","amem_submission"),t.ajax({url:acf.get("ajaxurl"),data:i,processData:!1,contentType:!1,type:"post",success:this.onSuccess(a),error:this.onError(a),complete:function(){e.unlock(a)}})},onSuccess:function(e){return function(a){var i=a.data;switch(acf.doAction("amem/form/ajax/submission",i,e),i.type){case"success_message":var n=t(i.success_message);e.$el.find(".amem-success-message, .amem-error-message, .amem-updated-message").remove(),e.$el.find('input[name="acf[user_password]"], input[name="acf[user_password_confirm]"], input[name="acf[user_password_current]"], input[name="user_password"], input[name="user_password_confirm"]').val(""),e.$el.find(".pass-strength-result, .pass-strength-result").html(""),e.$el.prepend(n);break;case"just_success_message":n=t(i.success_message),e.$el.find(".amem-fields").replaceWith(n);break;case"redirect":window.location.href=i.redirect_url}}},onError:function(e){return function(t){var a=e.$el.data("acf"),i=t.responseJSON.data.errors;a.addErrors(i),a.showErrors()}}},t(document).ready((function(){t(".amem-form").each((function(){e.setup_form(t(this))}))}))):console.error("acf-input.js not found. AMem requires ACF to work.")})();